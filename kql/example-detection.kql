SecurityEvent
| where EventID == 4624
| where LogonType == 3
| where TimeGenerated > ago(1h)
| extend SourceIP = case(
    IpAddress matches regex @"::ffff:(\d+\.\d+\.\d+\.\d+)", extract(@"::ffff:(\d+\.\d+\.\d+\.\d+)", 1, IpAddress),
    IpAddress matches regex @"\d+\.\d+\.\d+\.\d+", IpAddress,
    IpAddress
)
| where isnotempty(SourceIP)
| project TimeGenerated, Computer, SubjectUserName, SourceIP, LogonType, WorkstationName
